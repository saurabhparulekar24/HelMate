[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg)](https://classroom.github.com/a/SWcHbWxo)
# a10g-cloud

```
  * Team Number: 26
  * Team Name: Circuit Crusaders
  * Team Members: Binh Nguyen, Saurabh Parulekar
  * Github Repository URL: https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders
  * Description of test hardware: (development boards, sensors, actuators, laptop + OS, etc):
      + 1. 2 Samw25 Xplained Pro Boards, SDCard Module, LED Strip
      + 3. HP Pavilion Windows Gaming laptop, 15" 8GB i5
      + 4. Apple M2 Pro - Macbook
```

*You will be expanding on the codebase from A09G! Copy your A09G codebase into this repository before starting the assignment.*

## 1. OTAFU



https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/assets/57740824/e0954a5f-44c8-4b42-b270-0b1bd9804564



## 2. Node-RED Design
1. The smart helmet system uses MQTT for efficient message-based communication between the helmet hardware (client) and the cloud server. The system's functionality revolves around gathering sensor data, processing it, and using the insights for safety notifications and performance monitoring.
   + From Device to The Cloud: The helmet sends various types of sensor data to the cloud. This includes navigation data (LED Strip and Haptic Motor), blind spot and obstacle detection (IR Sensor), motion status and, (3-axis Accelerometer System)
   + Cloud Processing: The cloud server receives this data, where it's processed and stored. It analyzes data for any abnormal patterns that may indicate theft or crashes, and manages user-defined settings synchronization.
   + From Cloud to Device: Based on the analysis, the cloud sends back configuration updates, firmware updates, or emergency notifications. It may also send commands to activate/deactivate certain features based on user settings or detected conditions such as a crash or theft.
  
2. A list of the MQTT topics used, along with the type of information each handles:
+ helmet/navigation/data
  + Data Type: JSON string (includes latitude, longitude, and direction)
  + Description: Provide real-time location and intended route direction.
  + Published by: Node Red
  + Subscribed by: LED Strip and Haptic Motors
  
+ helmet/obstacle/blind spot system
  + Data Type: Array of integers
  + Description: Sends proximity measurements from IR sensors indicating distances to nearby obstacles.
  + Published by: IR Sensor
  + Subscribed by: Cloud Server

+ helmet/motion/status
  + Data Type: JSON string
  + Description: Reports the rider's motion status detected by the accelerometer, detailing if the rider is stationary, in motion, or in the event of sudden changes indicating a potential crash.
  + Published by: 3-axis accelerometer
  + Subscribed by: Cloud Server

+ helmet/led/control
  + Data Type: JSON string
  + Description: Receives commands to control the behavior of LED indicators for turns and braking.
  + Generated by: Cloud server
  + Subscribed by: LED Strip

+ helmet/config/update
  + Data Type: JSON string
  + Description: Receives configuration updates from the cloud, including user preferences and system settings.
  + Generated by: Cloud server
  + Subscribed by: Helmet Device

3. MCU Application Code and Threads Design
+ Sensor Management System: Handles reading data from multiple sensors (3-axis accelerometer, IR sensor, Haptic Motor and LED Strip)and then communicates to the data processing thread.
+ Feedback and Data Processing Thread: Processes sensor data, and decides on messages and feedback (haptic, LED) to activate and to be sent. Communicates with the Communication Thread for data dispatch.
+ Communication Thread: Load and update system configurations from non-volatile memory, and apply configuration updates received via MQTT. Communications are to send data to the cloud and receive commands or configuration updates from the cloud.

## 3. Node-RED Implementation

+ A video of your Node-RED setup working and explain how it operates.

Link: [Video's Link](https://drive.google.com/file/d/1LD-Vs2VgckuDJ5Hr0grkjkHWsvqkSMgx/view?usp=sharing)

+ Screenshots of your backend:

![Backend](https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/blob/main/images/part3_backend.png)

+ Screenshots of your frontend:

![Frontend](https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/blob/main/images/part3_frontend.png)

+ Node-RED source code:

Source Code: [JSON code](https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/blob/main/Node-RED/Part3.json)

+ A link to your Node-RED UI (the public URL):

Link: [Node Red UI Link](http://172.191.242.245:1880/ui/#!/2?socketid=1truOzmLad0T8MJnAAAB)


## 4. Bidirectional Cloud Communication

### Video



https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/assets/57740824/c7affbdd-e9aa-46bf-9afa-b71b2117888d



### Node Red Code for Bidirectional Communication

[Code](https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/blob/main/Node-RED/Part4.json)

### Node Red Public Link

[Node Red Link](http://172.191.242.245:1880/ui/#!/1?socketid=OuQKLyC7okkaOZGNAAAD)

## 5. Percepio Analysis

![Percipio](https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/blob/main/images/percipio.png)

[Percipio Trace](https://github.com/ese5160/a10g-cloud-t26-circuit-crusaders/blob/main/images/percipio_trace.bin)


In the trace, the green bars represent the execution periods of a control task, indicating active processing, while the red bars indicate the periods when a Wi-Fi task is running. The alternating pattern of these bars suggests that the system is switching between these two tasks, with the control task being scheduled and executed regularly, followed by the Wi-Fi task taking over, possibly suggesting that the system has well-defined periods of control processing interleaved with network communication handling. Currently, we do not have many tasks but we can see that the highest priority is the wifi task which also sends a MQTT message that is not visible in the trace.

## Github Repo Submission Resources

* [ESE5160 Example Repo Submission](https://github.com/ese5160/example-repository-submission)
* [Markdown Guide: Basic Syntax](https://www.markdownguide.org/basic-syntax/)
* [Adobe free video to gif converter](https://www.adobe.com/express/feature/video/convert/video-to-gif)
* [Curated list of example READMEs](https://github.com/matiassingers/awesome-readme)
* [VS Code](https://code.visualstudio.com/) is heavily recommended to develop code and handle Git commits
  * Code formatting and extension recommendation files come with this repository.
  * Ctrl+Shift+V will render the README.md (maybe not the images though)
